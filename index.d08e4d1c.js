"use strict";class lm_ThreeApp{constructor(){this.BACKGROUND_COLOR=16711680,this.cameraControlMode="Orbit",this.SSAO={enabled:!1,onlyAO:!1,radius:12,minDistance:.005,maxDistance:.1},this.Bokeh={enabled:!1,focusDistance:-1},this.FilmGrain={enabled:!1,noiseIntensity:.3,scanlineIntensity:0,scanlineCount:0,grayscale:!0},this.outlineOptions={objects:[],edgeStrength:3,edgeGlow:0,edgeThickness:1,visibleEdgeColor:new THREE.Color(1,1,1),hiddenEdgeColor:new THREE.Color(.1,.04,.02)},this.toonEffect={enabled:!1},this.rendererOptions={preserveDrawingBuffer:!0,antialias:!0,alpha:!1},this.continuousRendering=!0,this.showStats=!0,this.useEffectComposer=!1,this.clickTolerance=3,this.mainTimer=new lm.Stopwatch,this.mainTimer.Start()}SetupThreeJS(e){lm.DEBUG&&this.showStats&&(this.stats=new Stats,this.stats.setMode(0),this.stats.domElement.style.position="absolute",this.stats.domElement.style.left="220px",this.stats.domElement.style.top="0px",document.body.appendChild(this.stats.domElement)),this.canvasDiv=null,this.canvasWidth=window.innerWidth,this.canvasHeight=window.innerHeight,e?(this.canvasDiv=document.getElementById(e),this.canvasWidth=this.canvasDiv.clientWidth,this.canvasHeight=this.canvasDiv.clientHeight):this.canvasDiv=document.getElementById("WebGL-output"),this.scene=new THREE.Scene,this.scene.add(this.lightGroup=new THREE.Group),this.scene.add(this.extrasGroup=new THREE.Group),this.scene.add(this.userGroup=new THREE.Group),this.camera=new THREE.PerspectiveCamera(45,this.canvasWidth/this.canvasHeight,20,100),this.camera.position.set(-30,40,30),this.camera.lookAt(this.scene.position),"Orbit"==this.cameraControlMode?(this.camControls=new THREE.OrbitControls(this.camera,this.canvasDiv),this.camControls.screenSpacePanning=!0,this.camControls.rotateSpeed=1.5,this.camControls.zoomSpeed=1,this.camControls.panSpeed=1,this.camControls.keyPanSpeed=30):"Trackball"==this.cameraControlMode&&(this.camControls=new THREE.TrackballControls(this.camera,this.canvasDiv),this.camControls.rotateSpeed=1,this.camControls.zoomSpeed=1.2,this.camControls.panSpeed=.8,this.camControls.noZoom=!1,this.camControls.noPan=!1,this.camControls.staticMoving=!0,this.camControls.dynamicDampingFactor=.3,this.camControls.keys=[65,83,68]),this.camControls&&this.camControls.addEventListener("change",this.QueueRender.bind(this)),this.renderer=new THREE.WebGLRenderer(this.rendererOptions),this.rendererOptions.alpha?this.renderer.setClearColor(this.BACKGROUND_COLOR,0):this.renderer.setClearColor(this.BACKGROUND_COLOR,1),this.renderer.setSize(this.canvasWidth,this.canvasHeight),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=THREE.PCFSoftShadowMap,e?this.autoResize=!0:THREEx.WindowResize(this.renderer,this.camera),this.canvasDiv.appendChild(this.renderer.domElement),lm.ConnectMouseEvents(this.canvasDiv,this,{handleClick:!0,handleDoubleClick:!0}),this.Render();document.addEventListener("touchmove",(function(e){1!==e.scale&&e.preventDefault()}),{passive:!1});let t=0;document.addEventListener("touchend",(function(e){var s=(new Date).getTime();s-t<=300&&e.preventDefault(),t=s}),!1)}UpdateScene(e){}QueueRender(){this.queueRender=!0}_AnimationCallback(){this.Render()}Render(e){if(e&&(this.queueRender=!0),!this.continuousRendering&&!this.queueRender){if(this.autoResize&&(this.canvasWidth!=this.canvasDiv.clientWidth||this.canvasHeight!=this.canvasDiv.clientHeight)){if(this.canvasWidth=this.canvasDiv.clientWidth,this.canvasHeight=this.canvasDiv.clientHeight,this.renderer.setSize(this.canvasWidth,this.canvasHeight),this.camera.isOrthographicCamera){let e=this.camera.top*this.canvasWidth/this.canvasHeight;this.camera.left=-e,this.camera.right=e}else this.camera.aspect=this.canvasWidth/this.canvasHeight;this.camera.updateProjectionMatrix(),this.QueueRender()}return this.UpdateScene(!1),void requestAnimationFrame(this._AnimationCallback.bind(this))}if(this.queueRender=!1,lm.DEBUG&&this.stats&&this.stats.begin(),this.camControls&&this.camControls.update(),this.autoResize&&(this.canvasWidth!=this.canvasDiv.clientWidth||this.canvasHeight!=this.canvasDiv.clientHeight)){if(this.canvasWidth=this.canvasDiv.clientWidth,this.canvasHeight=this.canvasDiv.clientHeight,this.renderer.setSize(this.canvasWidth,this.canvasHeight),this.camera.isOrthographicCamera){let e=this.camera.top*this.canvasWidth/this.canvasHeight;this.camera.left=-e,this.camera.right=e}else this.camera.aspect=this.canvasWidth/this.canvasHeight;this.camera.updateProjectionMatrix()}if(this.useEffectComposer=!1,this.toonEffect.enabled?this.toonEffectObject||(this.toonEffectObject=new THREE.OutlineEffect(this.renderer,{defaultThickness:1,defaultColor:[0,1,0],defaultAlpha:1,defaultKeepAlive:!0})):(this.SSAO.enabled||this.Bokeh.enabled||this.FilmGrain.enabled||this.outlineOptions.objects.length>0)&&(this.useEffectComposer=!0),!this.effectComposer||this.useEffectComposer&&this.renderPass.camera==this.camera||(this.effectComposer=null,this.renderPass=null,this.ssaoPass=null,this.bokehPass=null,this.filmGrainPass=null,this.outlinePass=null),this.useEffectComposer&&!this.effectComposer&&(this.effectComposer=new THREE.EffectComposer(this.renderer)),this.useEffectComposer&&this.effectComposer){if(this.renderPass||(this.renderPass=new THREE.RenderPass(this.scene,this.camera),this.renderPass.clearColor=this.BACKGROUND_COLOR,this.renderPass.clearAlpha=1),this.SSAO.enabled&&(this.ssaoPass||(this.ssaoPass=new THREE.SSAOPass(this.scene,this.camera)),this.ssaoPass.kernelRadius=this.SSAO.radius,this.ssaoPass.minDistance=this.SSAO.minDistance,this.ssaoPass.maxDistance=this.SSAO.maxDistance,this.SSAO.onlyAO?this.ssaoPass.output=THREE.SSAOPass.OUTPUT.SSAO:this.ssaoPass.output=0),this.Bokeh.enabled){let e={focus:this.Bokeh.focusDistance,aperture:.0075,maxblur:.02};if(e.focus<0){let t=new THREE.Vector3;this.GetSceneBounds().getCenter(t),t.sub(this.camera.position),e.focus=t.length()}this.bokehPass&&!lm.RealEqual(this.bokehPass.uniforms.focus.value,e.focus,.001)&&(this.bokehPass=null),this.bokehPass||(this.bokehPass=new THREE.BokehPass(this.scene,this.camera,e),this.FilmGrain.enabled&&(this.bokehPass.needsSwap=!0))}else this.bokehPass=null;this.FilmGrain.enabled&&(this.filmGrainPass||(this.filmGrainPass=new THREE.FilmPass(this.FilmGrain.noiseIntensity,this.FilmGrain.scanlineIntensity,this.FilmGrain.scanlineCount,this.FilmGrain.grayscale))),this.outlineOptions.objects.length>0&&(this.outlinePass||(this.outlinePass=new THREE.OutlinePass(new THREE.Vector2(this.canvasWidth,this.canvasHeight),this.scene,this.camera)),this.outlinePass.edgeStrength=this.outlineOptions.edgeStrength,this.outlinePass.edgeGlow=this.outlineOptions.edgeGlow,this.outlinePass.edgeThickness=this.outlineOptions.edgeThickness,this.outlinePass.visibleEdgeColor=this.outlineOptions.visibleEdgeColor,this.outlinePass.hiddenEdgeColor=this.outlineOptions.hiddenEdgeColor),this.effectComposer.passes=[],this.effectComposer.addPass(this.renderPass),this.SSAO.enabled&&this.effectComposer.addPass(this.ssaoPass),this.Bokeh.enabled&&this.effectComposer.addPass(this.bokehPass),this.FilmGrain.enabled&&this.effectComposer.addPass(this.filmGrainPass),this.outlineOptions.objects.length>0&&this.effectComposer.addPass(this.outlinePass)}this.outlinePass&&(this.outlinePass.selectedObjects=this.outlineOptions.objects),this.UpdateScene(!0),this.userGroup.children.length<1&&(this.reportedEmptyUserGroup?this.reportedEmptyUserGroup++:this.reportedEmptyUserGroup=1,2==this.reportedEmptyUserGroup&&lm.Log("The user group is empty!")),this.toonEffect.enabled&&this.toonEffectObject.render(this.scene,this.camera),this.useEffectComposer&&this.effectComposer?this.effectComposer.render():this.renderer.render(this.scene,this.camera),this.overlayScene&&(this.renderer.autoClear=!1,this.renderer.clearDepth(),this.renderer.render(this.overlayScene,this.overlayCamera),this.renderer.autoClear=!0),lm.DEBUG&&this.stats&&this.stats.end(),e||requestAnimationFrame(this._AnimationCallback.bind(this))}GetSceneBounds(){let e=(new THREE.Box3).setFromObject(this.userGroup);return e.isEmpty()&&(e=(new THREE.Box3).setFromObject(this.extrasGroup)),e}ClearUserGroup(){for(;this.userGroup.children.length>0;)this.userGroup.remove(this.userGroup.children[0])}AutoSetCamera(e,t,s,i,a){i=lm.Default(i,1.1),a=lm.Default(a,0),this.cameraViewDir=lm.Default(this.cameraViewDir,"free");let n=this.GetSceneBounds();e&&n.set(new THREE.Vector3(e.min.x,e.min.y,e.min.z),new THREE.Vector3(e.max.x,e.max.y,e.max.z));let r=new THREE.Vector3;n.getCenter(r);let o=new THREE.Vector3;n.getSize(o);let h=lm.Max(o.x,lm.Max(o.y,o.z))*i,c=new THREE.Vector3(0,0,2*h);c.applyEuler(new THREE.Euler(lm.Rad(-20),lm.Rad(30),0,"YXZ")),c=c.add(r);let l=this.camera.position.clone(),m=this.camControls.target.clone();if("free"==this.cameraViewDir)this.camera=new THREE.PerspectiveCamera(45,this.canvasWidth/this.canvasHeight,t,s);else{"top"==this.cameraViewDir?(c.set(0,2*h,0),a=0):"bottom"==this.cameraViewDir?(c.set(0,2*-h,0),a=0):"front"==this.cameraViewDir?c.set(0,0,2*h):"back"==this.cameraViewDir?c.set(0,0,2*-h):"left"==this.cameraViewDir?c.set(2*-h,0,0):"right"==this.cameraViewDir&&c.set(2*h,0,0),c.add(r);let e=h/2.5,i=this.canvasWidth/this.canvasHeight;this.camera=new THREE.OrthographicCamera(-e*i,e*i,e,-e,t,s)}if(this.camera.near=lm.Default(t,.5*h),this.camera.far=lm.Default(s,4*h),this.camera.position.set(c.x,c.y,c.z),this.camera.up=new THREE.Vector3(0,1,0),this.camera.lookAt(r),this.camera.updateProjectionMatrix(),this.camControls&&(this.camControls.object=this.camera,this.camControls.target=r,this.camControls.update()),a>0){let e=this.camera.position.clone(),t=this.camControls.target.clone();this.camera.position.copy(l),this.camera.lookAt(m),this.camera.updateProjectionMatrix(),this.camControls.target=m,this.camControls.update(),this.cameraAnimating=!0,new lm.Animation(a,0,"elastic").Run(function(s,i){this.camera.position.x=lm.Lerp(s,l.x,e.x),this.camera.position.y=lm.Lerp(s,l.y,e.y),this.camera.position.z=lm.Lerp(s,l.z,e.z);let a=m.lerp(t,s);this.camera.lookAt(a),this.camera.updateProjectionMatrix(),this.camControls.target=a,this.camControls.update(),this.QueueRender(),i&&(this.cameraAnimating=!1)}.bind(this))}}IsAutosnapAxisAligned(e){new lm.Vector3(this.camera.position.x,this.camera.position.y,this.camera.position.z);let t=new THREE.Vector3;this.camera.getWorldDirection(t),t=new lm.Vector3(t.x,t.y,t.z),e=lm.Default(e,lm.Rad(20));let s=Math.cos(e),i="free",a=new lm.Vector3(t.x,t.y,t.z);return t.Dot(new lm.Vector3(0,0,-1))>s?(i="front",a.Set(0,0,-1)):t.Dot(new lm.Vector3(0,0,1))>s?(i="back",a.Set(0,0,1)):t.Dot(new lm.Vector3(0,-1,0))>s?(i="top",a.Set(0,-1,0)):t.Dot(new lm.Vector3(0,1,0))>s?(i="bottom",a.Set(0,1,0)):t.Dot(new lm.Vector3(1,0,0))>s?(i="left",a.Set(1,0,0)):t.Dot(new lm.Vector3(-1,0,0))>s&&(i="right",a.Set(-1,0,0)),"free"!=i}AutoSnapCamera(e,t,s,i){this.cameraViewDir=lm.Default(this.cameraViewDir,"free");let a=new lm.Vector3(this.camera.position.x,this.camera.position.y,this.camera.position.z),n=new THREE.Vector3;this.camera.getWorldDirection(n),n=new lm.Vector3(n.x,n.y,n.z);let r=100;(i=lm.Default(i,lm.Rad(20)))>0&&(r=Math.cos(i));let o="free",h=new lm.Vector3(n.x,n.y,n.z);n.Dot(new lm.Vector3(0,0,-1))>r?(o="front",h.Set(0,0,-1)):n.Dot(new lm.Vector3(0,0,1))>r?(o="back",h.Set(0,0,1)):n.Dot(new lm.Vector3(0,-1,0))>r?(o="top",h.Set(0,-1,0)):n.Dot(new lm.Vector3(0,1,0))>r?(o="bottom",h.Set(0,1,0)):n.Dot(new lm.Vector3(1,0,0))>r?(o="left",h.Set(1,0,0)):n.Dot(new lm.Vector3(-1,0,0))>r&&(o="right",h.Set(-1,0,0)),this.cameraViewDir=o;let c=this.GetSceneBounds();e&&c.set(new THREE.Vector3(e.min.x,e.min.y,e.min.z),new THREE.Vector3(e.max.x,e.max.y,e.max.z));let l=new THREE.Vector3;c.getCenter(l);let m=new lm.Vector3(l.x,l.y,l.z);m=m.Minus(a),h.TimesEq(h.Dot(m)),m=a.Plus(h),l.x=m.x,l.y=m.y,l.z=m.z;let d=this.camera.position;if("free"==this.cameraViewDir)this.camera.isOrthographicCamera&&(this.camera=new THREE.PerspectiveCamera(45,this.canvasWidth/this.canvasHeight,t,s));else{let e=h.Mag()/2.5,i=this.canvasWidth/this.canvasHeight;this.camera.isOrthographicCamera||(this.camera=new THREE.OrthographicCamera(-e*i,e*i,e,-e,t,s)),this.camControls&&(l.copy(this.camControls.target),d.x=l.x-h.x,d.y=l.y-h.y,d.z=l.z-h.z)}this.camera.position.copy(d),this.camera.up=new THREE.Vector3(0,1,0),this.camera.lookAt(l),this.camera.updateProjectionMatrix(),this.camControls&&(this.camControls.object=this.camera,this.camControls.target=l,this.camControls.update())}CreateAxes(){this.autoAxesObject&&(this.extrasGroup.remove(this.autoAxesObject),this.autoAxesObject=null);let e=this.GetSceneBounds(),t=new THREE.Vector3;e.getSize(t),this.autoAxesObject=new THREE.AxesHelper(lm.Max(t.x,lm.Max(t.y,t.z))),this.extrasGroup.add(this.autoAxesObject)}RemoveAxes(){this.autoAxesObject&&(this.extrasGroup.remove(this.autoAxesObject),this.autoAxesObject=null)}CreateAutoGround(e){this.autoGroundObject&&(this.extrasGroup.remove(this.autoGroundObject),this.autoGroundObject=null);let t=e.bounds;t||(t=this.GetSceneBounds());let s=1;e&&e.scale&&(s=e.scale);let i,a=lm.Max(t.XLength(),1.5*t.YLength()),n=lm.Max(a,t.ZLength()),r=new THREE.PlaneGeometry(a*s,n*s,1,1),o=13421772;e&&e.color&&(o=e.color),i=new THREE.MeshLambertMaterial({color:o}),this.autoGroundObject=new THREE.Mesh(r,i),this.autoGroundObject.castShadow=!1,this.autoGroundObject.receiveShadow=!0,this.autoGroundObject.rotation.x=-.5*Math.PI;let h=0;e&&e.yOffset&&(h=(t.max.y-t.min.y)*e.yOffset),this.autoGroundObject.position.set((t.min.x+t.max.x)/2,t.min.y+h,(t.min.z+t.max.z)/2),this.extrasGroup.add(this.autoGroundObject)}RemoveAutoGround(){this.autoGroundObject&&(this.extrasGroup.remove(this.autoGroundObject),this.autoGroundObject=null)}EnableExtras(e){e?this.scene.add(this.extrasGroup):this.scene.remove(this.extrasGroup)}AddThreePointLighting(e,t,s){for(t=lm.Default(t,1),s=lm.Default(s,1);this.lightGroup.children.length>0;)this.lightGroup.remove(this.lightGroup.children[0]);let i=this.GetSceneBounds(),a=new THREE.Vector3;i.getCenter(a);let n=new THREE.Vector3;i.getSize(n);let r=lm.Max(n.x,lm.Max(n.y,n.z)),o=new THREE.Vector3(0,0,2*r);o.applyEuler(new THREE.Euler(lm.Rad(-45),lm.Rad(-20),0,"YXZ")),o=o.add(a);let h=.75*r;if(this.keyLight=new THREE.DirectionalLight(16777215,.7*s),this.keyLight.position.set(o.x,o.y,o.z),this.keyLight.castShadow=!0,this.keyLight.shadow.mapSize.width=1024,this.keyLight.shadow.mapSize.height=1024,this.keyLight.shadow.camera.near=.5*r,this.keyLight.shadow.camera.far=4*r,this.keyLight.shadow.camera.right=h,this.keyLight.shadow.camera.left=-h,this.keyLight.shadow.camera.top=h,this.keyLight.shadow.camera.bottom=-h,this.lightGroup.add(this.keyLight),o.set(0,0,2*r),o.applyEuler(new THREE.Euler(lm.Rad(20),lm.Rad(60),0,"YXZ")),o=o.add(a),this.fillLight=new THREE.DirectionalLight(16777215,.5*t*s),this.fillLight.position.set(o.x,o.y,o.z),this.fillLight.shadow.mapSize.width=1024,this.fillLight.shadow.mapSize.height=1024,this.fillLight.shadow.camera.near=.5*r,this.fillLight.shadow.camera.far=4*r,this.fillLight.shadow.camera.right=h,this.fillLight.shadow.camera.left=-h,this.fillLight.shadow.camera.top=h,this.fillLight.shadow.camera.bottom=-h,this.lightGroup.add(this.fillLight),o.set(0,0,2*r),o.applyEuler(new THREE.Euler(lm.Rad(5),lm.Rad(-150),0,"YXZ")),o=o.add(a),this.backLight=new THREE.DirectionalLight(16772863,.75*t*s),this.backLight.position.set(o.x,o.y,o.z),this.backLight.shadow.mapSize.width=1024,this.backLight.shadow.mapSize.height=1024,this.backLight.shadow.camera.near=.5*r,this.backLight.shadow.camera.far=4*r,this.backLight.shadow.camera.right=h,this.backLight.shadow.camera.left=-h,this.backLight.shadow.camera.top=h,this.backLight.shadow.camera.bottom=-h,this.lightGroup.add(this.backLight),e){let e=new THREE.DirectionalLightHelper(this.keyLight,r/10,16711680);this.lightGroup.add(e);let t=new THREE.DirectionalLightHelper(this.fillLight,r/10,65280);this.lightGroup.add(t);let s=new THREE.DirectionalLightHelper(this.backLight,r/10,255);this.lightGroup.add(s)}}CreateOverlay(){if(this.overlayScene)return;let e=this.canvasWidth,t=this.canvasHeight;this.overlayCamera=new THREE.OrthographicCamera(0,e,0,t,-1e3,1e3),this.overlayCamera.position.x=0,this.overlayCamera.position.y=0,this.overlayCamera.position.z=0,this.overlayScene=new THREE.Scene}CreateOutlineFromBBox(e,t){let s=new THREE.Geometry;return s.vertices.push(new THREE.Vector3(e.min.x,e.max.y,e.min.z)),s.vertices.push(new THREE.Vector3(e.max.x,e.max.y,e.min.z)),s.vertices.push(new THREE.Vector3(e.max.x,e.max.y,e.min.z)),s.vertices.push(new THREE.Vector3(e.max.x,e.max.y,e.max.z)),s.vertices.push(new THREE.Vector3(e.max.x,e.max.y,e.max.z)),s.vertices.push(new THREE.Vector3(e.min.x,e.max.y,e.max.z)),s.vertices.push(new THREE.Vector3(e.min.x,e.max.y,e.max.z)),s.vertices.push(new THREE.Vector3(e.min.x,e.max.y,e.min.z)),s.vertices.push(new THREE.Vector3(e.min.x,e.min.y,e.min.z)),s.vertices.push(new THREE.Vector3(e.max.x,e.min.y,e.min.z)),s.vertices.push(new THREE.Vector3(e.max.x,e.min.y,e.min.z)),s.vertices.push(new THREE.Vector3(e.max.x,e.min.y,e.max.z)),s.vertices.push(new THREE.Vector3(e.max.x,e.min.y,e.max.z)),s.vertices.push(new THREE.Vector3(e.min.x,e.min.y,e.max.z)),s.vertices.push(new THREE.Vector3(e.min.x,e.min.y,e.max.z)),s.vertices.push(new THREE.Vector3(e.min.x,e.min.y,e.min.z)),s.vertices.push(new THREE.Vector3(e.min.x,e.min.y,e.min.z)),s.vertices.push(new THREE.Vector3(e.min.x,e.max.y,e.min.z)),s.vertices.push(new THREE.Vector3(e.max.x,e.min.y,e.min.z)),s.vertices.push(new THREE.Vector3(e.max.x,e.max.y,e.min.z)),s.vertices.push(new THREE.Vector3(e.max.x,e.min.y,e.max.z)),s.vertices.push(new THREE.Vector3(e.max.x,e.max.y,e.max.z)),s.vertices.push(new THREE.Vector3(e.min.x,e.min.y,e.max.z)),s.vertices.push(new THREE.Vector3(e.min.x,e.max.y,e.max.z)),new THREE.LineSegments(s,t)}AddBodyToScene(e,t){this.jsmMeshes||(this.jsmMeshes=[]);let s=JSM.ConvertBodyToThreeMeshes(e,t);for(let e=0;e<s.length;e++)this.jsmMeshes.push(s[e]),this.userGroup.add(s[e])}ExportOBJ(e){let t=(new THREE.OBJExporter).parse(this.scene),s=new Blob([t]);saveAs(s,e+".obj")}ExportGLB(e){(new THREE.GLTFExporter).parse(this.scene,(function(t){let s=new Blob([t]);saveAs(s,e+".glb")}),{onlyVisible:!0,binary:!0,embedImages:!0})}ExportPNG(e){this.renderer.domElement.toBlob((function(t){saveAs(t,e+".png")}),"image/png")}OnMouseDown(e,t){}OnMouseMove(e,t,s){}OnMouseUp(e,t){}OnClick(e,t){}OnDoubleClick(e,t){}}lm.ThreeApp=lm_ThreeApp,lm.TaperY=function(e,t,s,i){i||(e.computeBoundingBox(),i=e.boundingBox);let a=i.max.y-i.min.y;for(let n=0,r=e.vertices.length;n<r;n++){let r=e.vertices[n],o=(r.y-i.min.y)/a;r.x*=lm.Lerp(o,1,t),r.z*=lm.Lerp(o,1,s),e.vertices[n].x=r.x,e.vertices[n].z=r.z}e.computeBoundingBox()},lm.GenerateUVMap=function(e){e.faceVertexUvs[0]=[],e.computeBoundingBox();let t=e.boundingBox.min.clone(),s=new THREE.Vector3;e.boundingBox.getSize(s),s.x=1/s.x,s.y=1/s.y,s.z=1/s.z,e.faces.forEach((function(i){let a=["x","y","z"],n=e.vertices[i.a].clone(),r=e.vertices[i.b].clone(),o=e.vertices[i.c].clone();n.sub(t),r.sub(t),o.sub(t),n.multiply(s),r.multiply(s),o.multiply(s),n.x=lm.Lerp(.2,n.x,n.z),r.x=lm.Lerp(.2,r.x,r.z),o.x=lm.Lerp(.2,o.x,o.z),n.y=lm.Lerp(.2,n.y,n.z),r.y=lm.Lerp(.2,r.y,r.z),o.y=lm.Lerp(.2,o.y,o.z),e.faceVertexUvs[0].push([new THREE.Vector2(n[a[0]],n[a[1]]),new THREE.Vector2(r[a[0]],r[a[1]]),new THREE.Vector2(o[a[0]],o[a[1]])])})),e.elementsNeedUpdate=!0,e.uvsNeedUpdate=!0},lm.GenerateUVMap_old=function(e){e.faceVertexUvs[0]=[],e.computeBoundingBox();let t=new THREE.Vector3;e.boundingBox.getCenter(t);let s=new THREE.Vector3;e.boundingBox.getSize(s),s.x=1/(s.x/2),s.y=1/(s.y/2),s.z=1/(s.z/2),e.faces.forEach((function(i){let a=["x","y","z"],n=e.vertices[i.a].clone(),r=e.vertices[i.b].clone(),o=e.vertices[i.c].clone();n.sub(t),r.sub(t),o.sub(t),n.multiply(s),r.multiply(s),o.multiply(s),n.x=(n.x+1)/2,n.y=(n.y+1)/2,n.z=(n.z+1)/2,r.x=(r.x+1)/2,r.y=(r.y+1)/2,r.z=(r.z+1)/2,o.x=(o.x+1)/2,o.y=(o.y+1)/2,o.z=(o.z+1)/2,e.faceVertexUvs[0].push([new THREE.Vector2(n[a[0]],n[a[1]]),new THREE.Vector2(r[a[0]],r[a[1]]),new THREE.Vector2(o[a[0]],o[a[1]])])})),e.elementsNeedUpdate=!0,e.uvsNeedUpdate=!0},lm.GenerateUVMap_basedOnNormals=function(e){e.faceVertexUvs[0]=[],e.faces.forEach((function(t){let s=t.normal[t.a],i=t.normal[t.b],a=t.normal[t.c];e.faceVertexUvs[0].push([new THREE.Vector2(Math.atan2(s.z,s.x)/Math.PI*.5-.5,.5-Math.asin(s.y)/Math.PI),new THREE.Vector2(Math.atan2(i.z,i.x)/Math.PI*.5-.5,.5-Math.asin(i.y)/Math.PI),new THREE.Vector2(Math.atan2(a.z,a.x)/Math.PI*.5-.5,.5-Math.asin(a.y)/Math.PI)])})),e.uvsNeedUpdate=!0};
//# sourceMappingURL=index.d08e4d1c.js.map
